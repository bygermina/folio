import{r as u,j as h,f as J,h as ce,R as F,k as le,c as de,e as ue,T as K,g as fe}from"./index-BG1H8XRs.js";const P=typeof window<"u"?u.useLayoutEffect:u.useEffect;function Q(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function he({box:e,defaultHeight:t,defaultWidth:s,disabled:n,element:r,mode:i,style:c}){const{styleHeight:o,styleWidth:a}=u.useMemo(()=>({styleHeight:Q(c?.height),styleWidth:Q(c?.width)}),[c?.height,c?.width]),[l,f]=u.useState({height:t,width:s}),d=n||o!==void 0||i==="only-width"||o!==void 0&&a!==void 0;return P(()=>{if(r===null||d)return;const x=new ResizeObserver(b=>{for(const y of b){const{contentRect:S,target:g}=y;r===g&&f(I=>I.height===S.height&&I.width===S.width?I:{height:S.height,width:S.width})}});return x.observe(r,{box:e}),()=>{x?.unobserve(r)}},[e,d,r,o,a]),u.useMemo(()=>({height:o??l.height,width:a??l.width}),[l,o,a])}function me(e){const t=u.useRef(()=>{throw new Error("Cannot call during render.")});return P(()=>{t.current=e},[e]),u.useCallback(s=>t.current?.(s),[t])}function Z({containerElement:e,direction:t,isRtl:s,scrollOffset:n}){return n}function k(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function H(e,t){if(e===t)return!0;if(!!e!=!!t||(k(e!==void 0),k(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const s in e)if(!Object.is(t[s],e[s]))return!1;return!0}function ne({cachedBounds:e,itemCount:t,itemSize:s}){if(t===0)return 0;if(typeof s=="number")return t*s;{const n=e.get(e.size===0?0:e.size-1);k(n!==void 0,"Unexpected bounds cache miss");const r=(n.scrollOffset+n.size)/e.size;return t*r}}function ge({align:e,cachedBounds:t,index:s,itemCount:n,itemSize:r,containerScrollOffset:i,containerSize:c}){if(s<0||s>=n)throw RangeError(`Invalid index specified: ${s}`,{cause:`Index ${s} is not within the range of 0 - ${n-1}`});const o=ne({cachedBounds:t,itemCount:n,itemSize:r}),a=t.get(s),l=Math.max(0,Math.min(o-c,a.scrollOffset)),f=Math.max(0,a.scrollOffset-c+a.size);switch(e==="smart"&&(i>=f&&i<=l?e="auto":e="center"),e){case"start":return l;case"end":return f;case"center":return a.scrollOffset<=c/2?0:a.scrollOffset+a.size/2>=o-c/2?o-c:a.scrollOffset+a.size/2-c/2;case"auto":default:return i>=f&&i<=l?i:i<f?f:l}}function X({cachedBounds:e,containerScrollOffset:t,containerSize:s,itemCount:n,overscanCount:r}){const i=n-1;let c=0,o=-1,a=0,l=-1,f=0;for(;f<i;){const d=e.get(f);if(d.scrollOffset+d.size>t)break;f++}for(c=f,a=Math.max(0,c-r);f<i;){const d=e.get(f);if(d.scrollOffset+d.size>=t+s)break;f++}return o=Math.min(i,f),l=Math.min(n-1,o+r),c<0&&(c=0,o=-1,a=0,l=-1),{startIndexVisible:c,stopIndexVisible:o,startIndexOverscan:a,stopIndexOverscan:l}}function be({itemCount:e,itemProps:t,itemSize:s}){const n=new Map;return{get(r){for(k(r<e,`Invalid index ${r}`);n.size-1<r;){const c=n.size;let o;switch(typeof s){case"function":{o=s(c,t);break}case"number":{o=s;break}}if(c===0)n.set(c,{size:o,scrollOffset:0});else{const a=n.get(c-1);k(a!==void 0,`Unexpected bounds cache miss for index ${r}`),n.set(c,{scrollOffset:a.scrollOffset+a.size,size:o})}}const i=n.get(r);return k(i!==void 0,`Unexpected bounds cache miss for index ${r}`),i},set(r,i){n.set(r,i)},get size(){return n.size}}}function pe({itemCount:e,itemProps:t,itemSize:s}){return u.useMemo(()=>be({itemCount:e,itemProps:t,itemSize:s}),[e,t,s])}function we({containerSize:e,itemSize:t}){let s;switch(typeof t){case"string":{k(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),k(e!==void 0,"Container size must be defined if a percentage item size is specified"),s=e*parseInt(t)/100;break}default:{s=t;break}}return s}function xe({containerElement:e,containerStyle:t,defaultContainerSize:s=0,direction:n,isRtl:r=!1,itemCount:i,itemProps:c,itemSize:o,onResize:a,overscanCount:l}){const[f,d]=u.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:x,startIndexOverscan:b,stopIndexVisible:y,stopIndexOverscan:S}={startIndexVisible:Math.min(i-1,f.startIndexVisible),startIndexOverscan:Math.min(i-1,f.startIndexOverscan),stopIndexVisible:Math.min(i-1,f.stopIndexVisible),stopIndexOverscan:Math.min(i-1,f.stopIndexOverscan)},{height:g=s,width:I=s}=he({defaultHeight:s,defaultWidth:void 0,element:e,mode:"only-height",style:t}),O=u.useRef({height:0,width:0}),R=g,W=we({containerSize:R,itemSize:o});u.useLayoutEffect(()=>{if(typeof a=="function"){const m=O.current;(m.height!==g||m.width!==I)&&(a({height:g,width:I},{...m}),m.height=g,m.width=I)}},[g,a,I]);const v=pe({itemCount:i,itemProps:c,itemSize:W}),L=u.useCallback(m=>v.get(m),[v]),z=u.useCallback(()=>ne({cachedBounds:v,itemCount:i,itemSize:W}),[v,i,W]),T=u.useCallback(m=>{const j=Z({containerElement:e,direction:n,isRtl:r,scrollOffset:m});return X({cachedBounds:v,containerScrollOffset:j,containerSize:R,itemCount:i,overscanCount:l})},[v,e,R,n,r,i,l]);P(()=>{const m=e?.scrollTop??0;d(T(m))},[e,n,T]),P(()=>{if(!e)return;const m=()=>{d(j=>{const{scrollLeft:D,scrollTop:w}=e,p=Z({containerElement:e,direction:n,isRtl:r,scrollOffset:w}),C=X({cachedBounds:v,containerScrollOffset:p,containerSize:R,itemCount:i,overscanCount:l});return H(C,j)?j:C})};return e.addEventListener("scroll",m),()=>{e.removeEventListener("scroll",m)}},[v,e,R,n,i,l]);const _=me(({align:m="auto",containerScrollOffset:j,index:D})=>{let w=ge({align:m,cachedBounds:v,containerScrollOffset:j,containerSize:R,index:D,itemCount:i,itemSize:W});if(e){if(w=Z({containerElement:e,direction:n,isRtl:r,scrollOffset:w}),typeof e.scrollTo!="function"){const p=T(w);H(f,p)||d(p)}return w}});return{getCellBounds:L,getEstimatedSize:z,scrollToIndex:_,startIndexOverscan:b,startIndexVisible:x,stopIndexOverscan:S,stopIndexVisible:y}}function ve(e){return u.useMemo(()=>e,Object.values(e))}function Ie(e,t){const{ariaAttributes:s,style:n,...r}=e,{ariaAttributes:i,style:c,...o}=t;return H(s,i)&&H(n,c)&&H(r,o)}function ye(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Se="data-react-window-index";function ze({children:e,className:t,defaultHeight:s=0,listRef:n,onResize:r,onRowsRendered:i,overscanCount:c=3,rowComponent:o,rowCount:a,rowHeight:l,rowProps:f,tagName:d="div",style:x,...b}){const y=ve(f),S=u.useMemo(()=>u.memo(o,Ie),[o]),[g,I]=u.useState(null),O=ye(l),R=u.useMemo(()=>O?w=>l.getRowHeight(w)??l.getAverageRowHeight():l,[O,l]),{getCellBounds:W,getEstimatedSize:v,scrollToIndex:L,startIndexOverscan:z,startIndexVisible:T,stopIndexOverscan:_,stopIndexVisible:m}=xe({containerElement:g,containerStyle:x,defaultContainerSize:s,direction:"vertical",itemCount:a,itemProps:y,itemSize:R,onResize:r,overscanCount:c});u.useImperativeHandle(n,()=>({get element(){return g},scrollToRow({align:w="auto",behavior:p="auto",index:C}){const U=L({align:w,containerScrollOffset:g?.scrollTop??0,index:C});typeof g?.scrollTo=="function"&&g.scrollTo({behavior:p,top:U})}}),[g,L]),P(()=>{if(!g)return;const w=Array.from(g.children).filter((p,C)=>{if(p.hasAttribute("aria-hidden"))return!1;const U=`${z+C}`;return p.setAttribute(Se,U),!0});if(O)return l.observeRowElements(w)},[g,O,l,z,_]),u.useEffect(()=>{z>=0&&_>=0&&i&&i({startIndex:T,stopIndex:m},{startIndex:z,stopIndex:_})},[i,z,T,_,m]);const j=u.useMemo(()=>{const w=[];if(a>0)for(let p=z;p<=_;p++){const C=W(p);w.push(u.createElement(S,{...y,ariaAttributes:{"aria-posinset":p+1,"aria-setsize":a,role:"listitem"},key:p,index:p,style:{position:"absolute",left:0,transform:`translateY(${C.scrollOffset}px)`,height:O?void 0:C.size,width:"100%"}}))}return w},[S,W,O,a,y,z,_]),D=h.jsx("div",{"aria-hidden":!0,style:{height:v(),width:"100%",zIndex:-1}});return u.createElement(d,{role:"list",...b,className:t,ref:I,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...x}},j,e,D)}const Ce="_virtualizedTable_p8hv0_14",Oe={virtualizedTable:Ce},Re=({rowCount:e,rowComponent:t,rowHeight:s=48,height:n=600,className:r="",onVisibleRowsChange:i})=>{const c=o=>h.jsx(t,{...o});return h.jsx("div",{className:J(Oe.virtualizedTable,r),style:{height:n},children:h.jsx(ze,{rowComponent:c,rowCount:e,rowHeight:s,rowProps:{},onRowsRendered:({startIndex:o,stopIndex:a})=>{i&&i(o,a)},role:"presentation",style:{width:"100%",height:n}})})},_e="_card_1p13l_14",je={card:_e},se=u.forwardRef(({children:e,className:t,as:s="div",...n},r)=>h.jsx(s,{ref:r,className:J(je.card,t),...n,children:e}));se.displayName="Card";const re=(e,t)=>e.position===t.position&&e.top===t.top&&e.left===t.left&&e.width===t.width&&e.height===t.height,Ee=()=>(e,t)=>{if(e.index!==t.index)return!1;const s=e.style,n=t.style;return re(s,n)},ke=(e,t)=>(e.displayName===void 0&&("$$typeof"in e&&e.$$typeof?.toString().includes("Memo")?Object.assign(e,{displayName:t}):e.displayName=t),e),We="_row_1gxoj_14",Te="_dataCard_1gxoj_24",Me="_dataCardSelected_1gxoj_63",G={row:We,dataCard:Te,dataCardSelected:Me},Ne=({items:e,style:t,gap:s=8,renderItem:n,rowIndex:r})=>{if(!e?.length)return h.jsx("div",{className:G.row,style:t});const c=(Number(t.height)||48)-s*2;return h.jsx("div",{className:G.row,style:{...t,"--row-gap":`${s}px`,"--card-size":`${c}px`},children:e.map((o,a)=>h.jsx("div",{children:n(o)},a+r))})},ie=u.memo(Ne,(e,t)=>e.rowIndex!==t.rowIndex||e.gap!==t.gap||e.items!==t.items||e.renderItem!==t.renderItem?!1:re(e.style,t.style));ke(ie,"Row");const $e=({value:e,onToggle:t,className:s})=>{const[n,r]=u.useState(!1),i=u.useCallback(()=>{r(!0),t?.()},[t]),c=u.useCallback(o=>{(o.key==="Enter"||o.key===" ")&&i()},[i]);return ce(()=>{r(!1)},n?200:null),h.jsx("div",{className:J(G.dataCard,{[G.dataCardSelected]:n},s),role:"button",tabIndex:0,"aria-pressed":n,"data-role":"data-card",onClick:i,onKeyDown:c,children:e})},Ve=Object.freeze([]),ee=e=>{let t;const s=new Set,n=(l,f)=>{const d=typeof l=="function"?l(t):l;if(!Object.is(d,t)){const x=t;t=f??(typeof d!="object"||d===null)?d:Object.assign({},t,d),s.forEach(b=>b(t,x))}},r=()=>t,o={setState:n,getState:r,getInitialState:()=>a,subscribe:l=>(s.add(l),()=>s.delete(l))},a=t=e(n,r,o);return o},Ae=(e=>e?ee(e):ee),He=e=>e;function Be(e,t=He){const s=F.useSyncExternalStore(e.subscribe,F.useCallback(()=>t(e.getState()),[e,t]),F.useCallback(()=>t(e.getInitialState()),[e,t]));return F.useDebugValue(s),s}const te=e=>{const t=Ae(e),s=n=>Be(t,n);return Object.assign(s,t),s},Pe=(e=>e?te(e):te),Le=e=>(t,s,n)=>{const r=n.subscribe;return n.subscribe=((c,o,a)=>{let l=c;if(o){const f=a?.equalityFn||Object.is;let d=c(n.getState());l=x=>{const b=c(x);if(!f(d,b)){const y=d;o(d=b,y)}},a?.fireImmediately&&o(d,d)}return r(l)}),e(t,s,n)},De=Le;let N=null,$=null,B=null,M=null,A=0;const Fe=1e4,Ye=()=>{if(typeof window>"u"||typeof Worker>"u")return null;try{return new Worker(new URL("/folio/assets/data-worker-CWteliLL.js",import.meta.url),{type:"module"})}catch{return null}},Y=Ye(),qe=async e=>e===0?Promise.resolve():N&&$&&A===e||M&&A===e?M:(A=e,N=null,$=null,B=null,M=null,Y?(M=new Promise(t=>{const s=n=>{if(!n?.data||n.data.type!=="INIT_COMPLETE")return;const{entities:r,entityIds:i,rows:c,itemsPerRow:o}=n.data.payload;o===A&&(N=r,$=i,B=c,Y.removeEventListener("message",s),t())};Y.addEventListener("message",s),Y.postMessage({type:"INIT",payload:{itemsPerRow:e,totalItems:Fe}})}),M):Promise.resolve()),V=Pe()(De((e,t)=>{const s=async n=>{n!==0&&(await qe(n),N&&$&&B&&e({entities:N,entityIds:$,rows:B,itemsPerRow:n}))};return{entities:N||{},entityIds:$||[],rows:B||[],itemsPerRow:A,gap:8,toggleValue:n=>e(r=>{const i=r.entities[n];return i?{entities:{...r.entities,[n]:{...i,value:i.value===0?1:0}}}:r}),setItemsPerRow:n=>{t().itemsPerRow!==n&&s(n)},getRowItemIds:n=>t().rows[n]||[],getEntityValue:n=>t().entities[n]?.value}})),Ge=8,oe=u.memo(({itemId:e})=>{const t=V(r=>r.entities[e]?.value),s=V(r=>r.toggleValue),n=u.useCallback(()=>{s(e)},[e,s]);return t===void 0?null:h.jsx($e,{value:t,onToggle:n})},(e,t)=>e.itemId===t.itemId);oe.displayName="DataRowItem";const Ue=u.memo(({index:e,style:t})=>{const s=V(i=>i.rows),n=u.useMemo(()=>s[e]??Ve,[s,e]),r=u.useCallback(i=>h.jsx(oe,{itemId:i}),[]);return n?.length?h.jsx(ie,{items:n,style:t,gap:Ge,renderItem:r,rowIndex:e}):h.jsx("div",{style:t})},Ee()),Ke=({container:e,isEnabled:t,flashCount:s=6,flashDurationMs:n=500,intervalMs:r=200})=>{u.useEffect(()=>{if(!t||!e||s<=0||r<=0||n<=0)return;const c=setInterval(()=>{if(typeof document<"u"&&document.hidden)return;const o=e.querySelectorAll('[data-role="data-card"]'),a=o.length;if(!a)return;const l=Math.min(s,a),f=()=>Math.floor(Math.random()*a);for(let d=0;d<l;d++){const x=f(),b=o[x];b&&b.dataset.flash!=="true"&&(b.dataset.flash="true",setTimeout(()=>{b.dataset.flash==="true"&&(b.dataset.flash="false")},n))}},r);return()=>clearInterval(c)},[e,s,n,r,t])},Ze="_section_s97t6_14",Je="_heading_s97t6_25",Qe="_subheading_s97t6_30",Xe="_loading_s97t6_37",et="_dataContainer_s97t6_41",tt="_headingWrapper_s97t6_47",nt="_subheadingWrapper_s97t6_54",st="_dataContainerWrapper_s97t6_59",E={section:Ze,heading:Je,subheading:Qe,loading:Xe,dataContainer:et,headingWrapper:tt,subheadingWrapper:nt,dataContainerWrapper:st},ae=56,q=8,rt=({containerWidth:e})=>{if(e<=q)return 0;const s=ae-q*2+q,n=e-q;return Math.max(1,Math.floor(n/s))},it=u.memo(()=>{const e=u.useRef(null),t=u.useRef(null),s=le(t,!0).width,n=de(e,{threshold:0}),{screenHeight:r,screenWidth:i}=ue(),c=r||600,o=V(d=>d.rows.length),a=V(d=>d.itemsPerRow),l=V(d=>d.setItemsPerRow);Ke({container:t.current,isEnabled:o>0&&a>0&&n}),u.useEffect(()=>{const d=rt({containerWidth:s});!d||d===a||l(d)},[s,a,l]);const f="data-intensive-heading";return h.jsxs("div",{className:E.section,ref:e,"aria-labelledby":f,children:[h.jsx("div",{className:E.headingWrapper,children:h.jsx(K,{id:f,variant:"h1",className:E.heading,children:"Data intensive"})}),h.jsx("div",{className:E.subheadingWrapper,children:h.jsxs(K,{variant:"subheading",className:E.subheading,color:"muted",children:[h.jsx(K,{as:"span",variant:"body",color:"primary",weight:"medium",children:"Issue:"})," ","Rendering ",o*a," data points"]})}),h.jsx(se,{children:h.jsx("div",{ref:t,className:`${E.dataContainer} ${E.dataContainerWrapper}`,children:o>0?h.jsx(Re,{rowCount:o,rowComponent:Ue,rowHeight:ae,height:i<fe.MOBILE?c*.6:600}):h.jsx("div",{className:E.loading,children:"Loading data..."})})})]})});it.displayName="ThirdScreen";export{it as ThirdScreen};
