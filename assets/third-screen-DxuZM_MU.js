import{r as f,j as h,d as oe,R as q,f as de,m as P,T as K}from"./index-C9GCzI0O.js";import{u as ue}from"./use-element-visible-Cm0wIwZ5.js";const B=typeof window<"u"?f.useLayoutEffect:f.useEffect;function Q(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function fe({box:e,defaultHeight:t,defaultWidth:s,disabled:n,element:i,mode:o,style:a}){const{styleHeight:c,styleWidth:r}=f.useMemo(()=>({styleHeight:Q(a?.height),styleWidth:Q(a?.width)}),[a?.height,a?.width]),[l,d]=f.useState({height:t,width:s}),u=n||c!==void 0||o==="only-width"||c!==void 0&&r!==void 0;return B(()=>{if(i===null||u)return;const b=new ResizeObserver(m=>{for(const p of m){const{contentRect:w,target:I}=p;i===I&&d(y=>y.height===w.height&&y.width===w.width?y:{height:w.height,width:w.width})}});return b.observe(i,{box:e}),()=>{b?.unobserve(i)}},[e,u,i,c,r]),f.useMemo(()=>({height:c??l.height,width:r??l.width}),[l,c,r])}function he(e){const t=f.useRef(()=>{throw new Error("Cannot call during render.")});return B(()=>{t.current=e},[e]),f.useCallback(s=>t.current?.(s),[t])}function Z({containerElement:e,direction:t,isRtl:s,scrollOffset:n}){return n}function M(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function F(e,t){if(e===t)return!0;if(!!e!=!!t||(M(e!==void 0),M(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const s in e)if(!Object.is(t[s],e[s]))return!1;return!0}function re({cachedBounds:e,itemCount:t,itemSize:s}){if(t===0)return 0;if(typeof s=="number")return t*s;{const n=e.get(e.size===0?0:e.size-1);M(n!==void 0,"Unexpected bounds cache miss");const i=(n.scrollOffset+n.size)/e.size;return t*i}}function me({align:e,cachedBounds:t,index:s,itemCount:n,itemSize:i,containerScrollOffset:o,containerSize:a}){if(s<0||s>=n)throw RangeError(`Invalid index specified: ${s}`,{cause:`Index ${s} is not within the range of 0 - ${n-1}`});const c=re({cachedBounds:t,itemCount:n,itemSize:i}),r=t.get(s),l=Math.max(0,Math.min(c-a,r.scrollOffset)),d=Math.max(0,r.scrollOffset-a+r.size);switch(e==="smart"&&(o>=d&&o<=l?e="auto":e="center"),e){case"start":return l;case"end":return d;case"center":return r.scrollOffset<=a/2?0:r.scrollOffset+r.size/2>=c-a/2?c-a:r.scrollOffset+r.size/2-a/2;case"auto":default:return o>=d&&o<=l?o:o<d?d:l}}function X({cachedBounds:e,containerScrollOffset:t,containerSize:s,itemCount:n,overscanCount:i}){const o=n-1;let a=0,c=-1,r=0,l=-1,d=0;for(;d<o;){const u=e.get(d);if(u.scrollOffset+u.size>t)break;d++}for(a=d,r=Math.max(0,a-i);d<o;){const u=e.get(d);if(u.scrollOffset+u.size>=t+s)break;d++}return c=Math.min(o,d),l=Math.min(n-1,c+i),a<0&&(a=0,c=-1,r=0,l=-1),{startIndexVisible:a,stopIndexVisible:c,startIndexOverscan:r,stopIndexOverscan:l}}function ge({itemCount:e,itemProps:t,itemSize:s}){const n=new Map;return{get(i){for(M(i<e,`Invalid index ${i}`);n.size-1<i;){const a=n.size;let c;switch(typeof s){case"function":{c=s(a,t);break}case"number":{c=s;break}}if(a===0)n.set(a,{size:c,scrollOffset:0});else{const r=n.get(a-1);M(r!==void 0,`Unexpected bounds cache miss for index ${i}`),n.set(a,{scrollOffset:r.scrollOffset+r.size,size:c})}}const o=n.get(i);return M(o!==void 0,`Unexpected bounds cache miss for index ${i}`),o},set(i,o){n.set(i,o)},get size(){return n.size}}}function be({itemCount:e,itemProps:t,itemSize:s}){return f.useMemo(()=>ge({itemCount:e,itemProps:t,itemSize:s}),[e,t,s])}function Ie({containerSize:e,itemSize:t}){let s;switch(typeof t){case"string":{M(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),M(e!==void 0,"Container size must be defined if a percentage item size is specified"),s=e*parseInt(t)/100;break}default:{s=t;break}}return s}function we({containerElement:e,containerStyle:t,defaultContainerSize:s=0,direction:n,isRtl:i=!1,itemCount:o,itemProps:a,itemSize:c,onResize:r,overscanCount:l}){const[d,u]=f.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:b,startIndexOverscan:m,stopIndexVisible:p,stopIndexOverscan:w}={startIndexVisible:Math.min(o-1,d.startIndexVisible),startIndexOverscan:Math.min(o-1,d.startIndexOverscan),stopIndexVisible:Math.min(o-1,d.stopIndexVisible),stopIndexOverscan:Math.min(o-1,d.stopIndexOverscan)},{height:I=s,width:y=s}=fe({defaultHeight:s,defaultWidth:void 0,element:e,mode:"only-height",style:t}),R=f.useRef({height:0,width:0}),O=I,T=Ie({containerSize:O,itemSize:c});f.useLayoutEffect(()=>{if(typeof r=="function"){const g=R.current;(g.height!==I||g.width!==y)&&(r({height:I,width:y},{...g}),g.height=I,g.width=y)}},[I,r,y]);const S=be({itemCount:o,itemProps:a,itemSize:T}),D=f.useCallback(g=>S.get(g),[S]),z=f.useCallback(()=>re({cachedBounds:S,itemCount:o,itemSize:T}),[S,o,T]),V=f.useCallback(g=>{const E=Z({containerElement:e,direction:n,isRtl:i,scrollOffset:g});return X({cachedBounds:S,containerScrollOffset:E,containerSize:O,itemCount:o,overscanCount:l})},[S,e,O,n,i,o,l]);B(()=>{const g=e?.scrollTop??0;u(V(g))},[e,n,V]),B(()=>{if(!e)return;const g=()=>{u(E=>{const{scrollLeft:L,scrollTop:v}=e,x=Z({containerElement:e,direction:n,isRtl:i,scrollOffset:v}),C=X({cachedBounds:S,containerScrollOffset:x,containerSize:O,itemCount:o,overscanCount:l});return F(C,E)?E:C})};return e.addEventListener("scroll",g),()=>{e.removeEventListener("scroll",g)}},[S,e,O,n,o,l]);const j=he(({align:g="auto",containerScrollOffset:E,index:L})=>{let v=me({align:g,cachedBounds:S,containerScrollOffset:E,containerSize:O,index:L,itemCount:o,itemSize:T});if(e){if(v=Z({containerElement:e,direction:n,isRtl:i,scrollOffset:v}),typeof e.scrollTo!="function"){const x=V(v);F(d,x)||u(x)}return v}});return{getCellBounds:D,getEstimatedSize:z,scrollToIndex:j,startIndexOverscan:m,startIndexVisible:b,stopIndexOverscan:w,stopIndexVisible:p}}function xe(e){return f.useMemo(()=>e,Object.values(e))}function pe(e,t){const{ariaAttributes:s,style:n,...i}=e,{ariaAttributes:o,style:a,...c}=t;return F(s,o)&&F(n,a)&&F(i,c)}function ve(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Se="data-react-window-index";function ye({children:e,className:t,defaultHeight:s=0,listRef:n,onResize:i,onRowsRendered:o,overscanCount:a=3,rowComponent:c,rowCount:r,rowHeight:l,rowProps:d,tagName:u="div",style:b,...m}){const p=xe(d),w=f.useMemo(()=>f.memo(c,pe),[c]),[I,y]=f.useState(null),R=ve(l),O=f.useMemo(()=>R?v=>l.getRowHeight(v)??l.getAverageRowHeight():l,[R,l]),{getCellBounds:T,getEstimatedSize:S,scrollToIndex:D,startIndexOverscan:z,startIndexVisible:V,stopIndexOverscan:j,stopIndexVisible:g}=we({containerElement:I,containerStyle:b,defaultContainerSize:s,direction:"vertical",itemCount:r,itemProps:p,itemSize:O,onResize:i,overscanCount:a});f.useImperativeHandle(n,()=>({get element(){return I},scrollToRow({align:v="auto",behavior:x="auto",index:C}){const G=D({align:v,containerScrollOffset:I?.scrollTop??0,index:C});typeof I?.scrollTo=="function"&&I.scrollTo({behavior:x,top:G})}}),[I,D]),B(()=>{if(!I)return;const v=Array.from(I.children).filter((x,C)=>{if(x.hasAttribute("aria-hidden"))return!1;const G=`${z+C}`;return x.setAttribute(Se,G),!0});if(R)return l.observeRowElements(v)},[I,R,l,z,j]),f.useEffect(()=>{z>=0&&j>=0&&o&&o({startIndex:V,stopIndex:g},{startIndex:z,stopIndex:j})},[o,z,V,j,g]);const E=f.useMemo(()=>{const v=[];if(r>0)for(let x=z;x<=j;x++){const C=T(x);v.push(f.createElement(w,{...p,ariaAttributes:{"aria-posinset":x+1,"aria-setsize":r,role:"listitem"},key:x,index:x,style:{position:"absolute",left:0,transform:`translateY(${C.scrollOffset}px)`,height:R?void 0:C.size,width:"100%"}}))}return v},[w,T,R,r,p,z,j]),L=h.jsx("div",{"aria-hidden":!0,style:{height:S(),width:"100%",zIndex:-1}});return f.createElement(u,{role:"list",...m,className:t,ref:y,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...b}},E,e,L)}const ze="_virtualizedTable_1k3ib_14",Ce={virtualizedTable:ze},Re=({rowCount:e,rowComponent:t,rowHeight:s=48,height:n=600,className:i=""})=>{const o=a=>h.jsx(t,{...a});return h.jsx("div",{className:oe(Ce.virtualizedTable,i),style:{height:n},children:h.jsx(ye,{rowComponent:o,rowCount:e,rowHeight:s,rowProps:{},style:{width:"100%",height:n}})})},Oe="_row_z9ikb_14",je="_dataCard_z9ikb_24",Ee="_dataCardSelected_z9ikb_60",_e="_dataCardFlash_z9ikb_66",$={row:Oe,dataCard:je,dataCardSelected:Ee,dataCardFlash:_e},ke=({items:e,style:t,gap:s=8,renderItem:n,rowIndex:i})=>{if(!e?.length)return h.jsx("div",{className:$.row,style:t});console.log(i);const a=(Number(t.height)||48)-s*2;return h.jsx("div",{className:$.row,style:{...t,"--row-gap":`${s}px`,"--card-size":`${a}px`},children:e.map((c,r)=>h.jsx("div",{children:n(c)},r+i))})},ae=f.memo(ke,(e,t)=>{if(e.rowIndex!==t.rowIndex||e.gap!==t.gap||e.items!==t.items||e.renderItem!==t.renderItem)return!1;const s=e.style,n=t.style;return s.position===n.position&&s.top===n.top&&s.left===n.left&&s.width===n.width&&s.height===n.height});Object.assign(ae,{displayName:"Row"});const Me=f.memo(({value:e,onToggle:t,isFlashing:s=!1,className:n})=>{const[i,o]=f.useState(!1),a=f.useCallback(()=>{o(!0),t?.(),setTimeout(()=>o(!1),200)},[t]);return h.jsx("div",{className:oe($.dataCard,i&&$.dataCardSelected,s&&$.dataCardFlash,n),onClick:a,children:e})}),ee=e=>{let t;const s=new Set,n=(l,d)=>{const u=typeof l=="function"?l(t):l;if(!Object.is(u,t)){const b=t;t=d??(typeof u!="object"||u===null)?u:Object.assign({},t,u),s.forEach(m=>m(t,b))}},i=()=>t,c={setState:n,getState:i,getInitialState:()=>r,subscribe:l=>(s.add(l),()=>s.delete(l))},r=t=e(n,i,c);return c},Te=(e=>e?ee(e):ee),Ve=e=>e;function Ae(e,t=Ve){const s=q.useSyncExternalStore(e.subscribe,q.useCallback(()=>t(e.getState()),[e,t]),q.useCallback(()=>t(e.getInitialState()),[e,t]));return q.useDebugValue(s),s}const te=e=>{const t=Te(e),s=n=>Ae(t,n);return Object.assign(s,t),s},Ne=(e=>e?te(e):te),He=e=>(t,s,n)=>{const i=n.subscribe;return n.subscribe=((a,c,r)=>{let l=a;if(c){const d=r?.equalityFn||Object.is;let u=a(n.getState());l=b=>{const m=a(b);if(!d(u,m)){const p=u;c(u=m,p)}},r?.fireImmediately&&c(u,u)}return i(l)}),e(t,s,n)},Fe=He;let ce=0;const $e=e=>Array.from({length:e},()=>({id:ce++,value:Math.random()>.5?1:0}));let N=null,_=null,W=null,A=null,Y=0;const J=100,ne=1e4,se=e=>{typeof requestIdleCallback<"u"?requestIdleCallback(e,{timeout:5}):setTimeout(e,0)},We=async e=>{if(e===0)return Promise.resolve();if(N&&_&&Y===e||A&&Y===e)return A;Y=e,N=null,_=null,W=null,A=null,ce=0;const t=Math.ceil(ne/J);return A=new Promise(s=>{const n=[];let i=0;const o=()=>{const a=i*J,r=Math.min(a+J,ne)-a,l=$e(r);n.push(...l),i++,i<t?se(o):(N=Object.fromEntries(n.map(d=>[d.id,d])),_=n.map(d=>d.id),W=Array.from({length:Math.ceil(_.length/e)},(d,u)=>_.slice(u*e,(u+1)*e)),s())};se(o)}),A},k=Ne()(Fe((e,t)=>{const s=async n=>{n!==0&&(await We(n),N&&_&&W&&e({entities:N,entityIds:_,rows:W,itemsPerRow:n}))};return{entities:N||{},entityIds:_||[],rows:W||[],itemsPerRow:Y,gap:8,visibleRowStartIndex:0,visibleRowStopIndex:20,flashingItemIds:{},toggleValue:n=>e(i=>{const o=i.entities[n];return o?{entities:{...i.entities,[n]:{...o,value:o.value===0?1:0}}}:i}),setItemsPerRow:n=>{t().itemsPerRow!==n&&s(n)},setVisibleRowRange:(n,i)=>{const o=t();(o.visibleRowStartIndex!==n||o.visibleRowStopIndex!==i)&&e({visibleRowStartIndex:n,visibleRowStopIndex:i})},getRowItemIds:n=>t().rows[n]||[],getEntityValue:n=>t().entities[n]?.value,triggerRandomFlash:(n=1)=>{e(i=>{if(!i.rows.length)return i;const o=i.visibleRowStartIndex,a=i.visibleRowStopIndex,c=[];for(let u=0;u<n;u++){const b=Math.floor(Math.random()*(a-o+1))+o,m=i.rows[b];if(m&&m.length>0){const p=Math.floor(Math.random()*m.length),w=m[p];w!==void 0&&!i.flashingItemIds[w]&&c.push(w)}}if(c.length===0)return i;const r={};c.forEach(u=>{r[u]=!0});const l={...i.flashingItemIds,...r},d=c;return setTimeout(()=>{e(u=>{const{flashingItemIds:b}=u,m=Object.fromEntries(Object.entries(b).filter(([p])=>!d.includes(Number(p))));return Object.keys(m).length===Object.keys(b).length?u:{flashingItemIds:m}})},300),{flashingItemIds:l}})},isItemFlashing:n=>t().flashingItemIds[n]===!0}})),Be=[],De=8,le=f.memo(({itemId:e})=>{const t=k(o=>o.entities[e]?.value),s=k(o=>o.toggleValue),n=k(o=>o.flashingItemIds[e]===!0),i=f.useCallback(()=>{s(e)},[e,s]);return t===void 0?null:h.jsx(Me,{value:t,onToggle:i,isFlashing:n})},(e,t)=>e.itemId===t.itemId);le.displayName="DataRowItem";const Le=f.memo(({index:e,style:t})=>{const s=k(o=>o.rows),n=f.useMemo(()=>s[e]||Be,[s,e]),i=f.useCallback(o=>h.jsx(le,{itemId:o}),[]);return n?.length?h.jsx(ae,{items:n,style:t,gap:De,renderItem:i,rowIndex:e}):h.jsx("div",{style:t})},(e,t)=>{if(e.index!==t.index)return!1;const s=e.style,n=t.style;return s.position===n.position&&s.top===n.top&&s.left===n.left&&s.width===n.width&&s.height===n.height}),qe="_section_rrnbg_14",Ue="_heading_rrnbg_25",Ye="_subheading_rrnbg_30",Ge="_loading_rrnbg_37",Pe="_dataContainer_rrnbg_41",H={section:qe,heading:Ue,subheading:Ye,loading:Ge,dataContainer:Pe},ie=56,U=8,Ke=f.memo(()=>{const e=f.useRef(null),t=ue(e),s=f.useRef(null),n=de(s,!0).width,i=k(r=>r.rows.length),o=k(r=>r.itemsPerRow),a=k(r=>r.setItemsPerRow),c=k(r=>r.triggerRandomFlash);return f.useEffect(()=>{if(!t)return;const r=setInterval(()=>{c(3)},150);return()=>{clearInterval(r)}},[t,c]),f.useLayoutEffect(()=>{const r=s.current;if(!r||n<=0)return;const l=window.getComputedStyle(r),d=parseFloat(l.paddingLeft)||0,u=parseFloat(l.paddingRight)||0,m=n-d-u-U*2,p=ie-U*2,w=Math.max(1,Math.floor((m+U)/(p+U)));w!==o&&a(w)},[n,o,a]),h.jsxs("section",{className:H.section,ref:e,children:[h.jsx(P.div,{initial:{opacity:0,y:30,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{duration:.8,delay:.3},children:h.jsx(K,{variant:"h1",className:H.heading,children:"Data intensive"})}),h.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:3.5},children:h.jsxs(K,{variant:"subheading",className:H.subheading,color:"muted",children:[h.jsx(K,{as:"span",variant:"body",color:"primary",weight:"medium",children:"Issue:"})," ","Rendering ",i*o," data points"]})}),h.jsx(P.div,{ref:s,className:H.dataContainer,initial:{opacity:0},animate:{opacity:1},transition:{duration:1,delay:1},children:i>0?h.jsx(Re,{rowCount:i,rowComponent:Le,rowHeight:ie,height:600}):h.jsx("div",{className:H.loading,children:"Loading data..."})})]})});Ke.displayName="ThirdScreen";export{Ke as ThirdScreen};
