import{r as f,j as h,d as oe,R as L,f as de,m as Y,T as K}from"./index-BJtNoAdR.js";import{u as ue}from"./use-element-visible-BkthuOeB.js";const P=typeof window<"u"?f.useLayoutEffect:f.useEffect;function Q(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function fe({box:e,defaultHeight:t,defaultWidth:o,disabled:n,element:s,mode:i,style:a}){const{styleHeight:c,styleWidth:r}=f.useMemo(()=>({styleHeight:Q(a?.height),styleWidth:Q(a?.width)}),[a?.height,a?.width]),[l,d]=f.useState({height:t,width:o}),u=n||c!==void 0||i==="only-width"||c!==void 0&&r!==void 0;return P(()=>{if(s===null||u)return;const I=new ResizeObserver(g=>{for(const x of g){const{contentRect:p,target:m}=x;s===m&&d(y=>y.height===p.height&&y.width===p.width?y:{height:p.height,width:p.width})}});return I.observe(s,{box:e}),()=>{I?.unobserve(s)}},[e,u,s,c,r]),f.useMemo(()=>({height:c??l.height,width:r??l.width}),[l,c,r])}function he(e){const t=f.useRef(()=>{throw new Error("Cannot call during render.")});return P(()=>{t.current=e},[e]),f.useCallback(o=>t.current?.(o),[t])}function Z({containerElement:e,direction:t,isRtl:o,scrollOffset:n}){return n}function M(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function F(e,t){if(e===t)return!0;if(!!e!=!!t||(M(e!==void 0),M(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(const o in e)if(!Object.is(t[o],e[o]))return!1;return!0}function re({cachedBounds:e,itemCount:t,itemSize:o}){if(t===0)return 0;if(typeof o=="number")return t*o;{const n=e.get(e.size===0?0:e.size-1);M(n!==void 0,"Unexpected bounds cache miss");const s=(n.scrollOffset+n.size)/e.size;return t*s}}function me({align:e,cachedBounds:t,index:o,itemCount:n,itemSize:s,containerScrollOffset:i,containerSize:a}){if(o<0||o>=n)throw RangeError(`Invalid index specified: ${o}`,{cause:`Index ${o} is not within the range of 0 - ${n-1}`});const c=re({cachedBounds:t,itemCount:n,itemSize:s}),r=t.get(o),l=Math.max(0,Math.min(c-a,r.scrollOffset)),d=Math.max(0,r.scrollOffset-a+r.size);switch(e==="smart"&&(i>=d&&i<=l?e="auto":e="center"),e){case"start":return l;case"end":return d;case"center":return r.scrollOffset<=a/2?0:r.scrollOffset+r.size/2>=c-a/2?c-a:r.scrollOffset+r.size/2-a/2;case"auto":default:return i>=d&&i<=l?i:i<d?d:l}}function X({cachedBounds:e,containerScrollOffset:t,containerSize:o,itemCount:n,overscanCount:s}){const i=n-1;let a=0,c=-1,r=0,l=-1,d=0;for(;d<i;){const u=e.get(d);if(u.scrollOffset+u.size>t)break;d++}for(a=d,r=Math.max(0,a-s);d<i;){const u=e.get(d);if(u.scrollOffset+u.size>=t+o)break;d++}return c=Math.min(i,d),l=Math.min(n-1,c+s),a<0&&(a=0,c=-1,r=0,l=-1),{startIndexVisible:a,stopIndexVisible:c,startIndexOverscan:r,stopIndexOverscan:l}}function ge({itemCount:e,itemProps:t,itemSize:o}){const n=new Map;return{get(s){for(M(s<e,`Invalid index ${s}`);n.size-1<s;){const a=n.size;let c;switch(typeof o){case"function":{c=o(a,t);break}case"number":{c=o;break}}if(a===0)n.set(a,{size:c,scrollOffset:0});else{const r=n.get(a-1);M(r!==void 0,`Unexpected bounds cache miss for index ${s}`),n.set(a,{scrollOffset:r.scrollOffset+r.size,size:c})}}const i=n.get(s);return M(i!==void 0,`Unexpected bounds cache miss for index ${s}`),i},set(s,i){n.set(s,i)},get size(){return n.size}}}function be({itemCount:e,itemProps:t,itemSize:o}){return f.useMemo(()=>ge({itemCount:e,itemProps:t,itemSize:o}),[e,t,o])}function Ie({containerSize:e,itemSize:t}){let o;switch(typeof t){case"string":{M(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),M(e!==void 0,"Container size must be defined if a percentage item size is specified"),o=e*parseInt(t)/100;break}default:{o=t;break}}return o}function ve({containerElement:e,containerStyle:t,defaultContainerSize:o=0,direction:n,isRtl:s=!1,itemCount:i,itemProps:a,itemSize:c,onResize:r,overscanCount:l}){const[d,u]=f.useState({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:I,startIndexOverscan:g,stopIndexVisible:x,stopIndexOverscan:p}={startIndexVisible:Math.min(i-1,d.startIndexVisible),startIndexOverscan:Math.min(i-1,d.startIndexOverscan),stopIndexVisible:Math.min(i-1,d.stopIndexVisible),stopIndexOverscan:Math.min(i-1,d.stopIndexOverscan)},{height:m=o,width:y=o}=fe({defaultHeight:o,defaultWidth:void 0,element:e,mode:"only-height",style:t}),R=f.useRef({height:0,width:0}),j=m,T=Ie({containerSize:j,itemSize:c});f.useLayoutEffect(()=>{if(typeof r=="function"){const b=R.current;(b.height!==m||b.width!==y)&&(r({height:m,width:y},{...b}),b.height=m,b.width=y)}},[m,r,y]);const S=be({itemCount:i,itemProps:a,itemSize:T}),B=f.useCallback(b=>S.get(b),[S]),z=f.useCallback(()=>re({cachedBounds:S,itemCount:i,itemSize:T}),[S,i,T]),V=f.useCallback(b=>{const _=Z({containerElement:e,direction:n,isRtl:s,scrollOffset:b});return X({cachedBounds:S,containerScrollOffset:_,containerSize:j,itemCount:i,overscanCount:l})},[S,e,j,n,s,i,l]);P(()=>{const b=e?.scrollTop??0;u(V(b))},[e,n,V]),P(()=>{if(!e)return;const b=()=>{u(_=>{const{scrollLeft:D,scrollTop:w}=e,v=Z({containerElement:e,direction:n,isRtl:s,scrollOffset:w}),C=X({cachedBounds:S,containerScrollOffset:v,containerSize:j,itemCount:i,overscanCount:l});return F(C,_)?_:C})};return e.addEventListener("scroll",b),()=>{e.removeEventListener("scroll",b)}},[S,e,j,n,i,l]);const E=he(({align:b="auto",containerScrollOffset:_,index:D})=>{let w=me({align:b,cachedBounds:S,containerScrollOffset:_,containerSize:j,index:D,itemCount:i,itemSize:T});if(e){if(w=Z({containerElement:e,direction:n,isRtl:s,scrollOffset:w}),typeof e.scrollTo!="function"){const v=V(w);F(d,v)||u(v)}return w}});return{getCellBounds:B,getEstimatedSize:z,scrollToIndex:E,startIndexOverscan:g,startIndexVisible:I,stopIndexOverscan:p,stopIndexVisible:x}}function xe(e){return f.useMemo(()=>e,Object.values(e))}function pe(e,t){const{ariaAttributes:o,style:n,...s}=e,{ariaAttributes:i,style:a,...c}=t;return F(o,i)&&F(n,a)&&F(s,c)}function we(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}const Se="data-react-window-index";function ye({children:e,className:t,defaultHeight:o=0,listRef:n,onResize:s,onRowsRendered:i,overscanCount:a=3,rowComponent:c,rowCount:r,rowHeight:l,rowProps:d,tagName:u="div",style:I,...g}){const x=xe(d),p=f.useMemo(()=>f.memo(c,pe),[c]),[m,y]=f.useState(null),R=we(l),j=f.useMemo(()=>R?w=>l.getRowHeight(w)??l.getAverageRowHeight():l,[R,l]),{getCellBounds:T,getEstimatedSize:S,scrollToIndex:B,startIndexOverscan:z,startIndexVisible:V,stopIndexOverscan:E,stopIndexVisible:b}=ve({containerElement:m,containerStyle:I,defaultContainerSize:o,direction:"vertical",itemCount:r,itemProps:x,itemSize:j,onResize:s,overscanCount:a});f.useImperativeHandle(n,()=>({get element(){return m},scrollToRow({align:w="auto",behavior:v="auto",index:C}){const G=B({align:w,containerScrollOffset:m?.scrollTop??0,index:C});typeof m?.scrollTo=="function"&&m.scrollTo({behavior:v,top:G})}}),[m,B]),P(()=>{if(!m)return;const w=Array.from(m.children).filter((v,C)=>{if(v.hasAttribute("aria-hidden"))return!1;const G=`${z+C}`;return v.setAttribute(Se,G),!0});if(R)return l.observeRowElements(w)},[m,R,l,z,E]),f.useEffect(()=>{z>=0&&E>=0&&i&&i({startIndex:V,stopIndex:b},{startIndex:z,stopIndex:E})},[i,z,V,E,b]);const _=f.useMemo(()=>{const w=[];if(r>0)for(let v=z;v<=E;v++){const C=T(v);w.push(f.createElement(p,{...x,ariaAttributes:{"aria-posinset":v+1,"aria-setsize":r,role:"listitem"},key:v,index:v,style:{position:"absolute",left:0,transform:`translateY(${C.scrollOffset}px)`,height:R?void 0:C.size,width:"100%"}}))}return w},[p,T,R,r,x,z,E]),D=h.jsx("div",{"aria-hidden":!0,style:{height:S(),width:"100%",zIndex:-1}});return f.createElement(u,{role:"list",...g,className:t,ref:y,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...I}},_,e,D)}const ze="_virtualizedTable_szokt_1",Ce={virtualizedTable:ze},Oe=({rowCount:e,rowComponent:t,rowHeight:o=48,height:n=600,className:s=""})=>{const i=a=>h.jsx(t,{...a});return h.jsx("div",{className:oe(Ce.virtualizedTable,s),style:{height:n},children:h.jsx(ye,{rowComponent:i,rowCount:e,rowHeight:o,rowProps:{},style:{width:"100%",height:n}})})},Re="_row_zz80h_1",je="_dataCard_zz80h_11",Ee="_dataCardSelected_zz80h_47",_e="_dataCardFlash_zz80h_53",W={row:Re,dataCard:je,dataCardSelected:Ee,dataCardFlash:_e},ae=({items:e,style:t,gap:o=8,renderItem:n,rowIndex:s})=>{if(!e?.length)return h.jsx("div",{className:W.row,style:t});const a=(Number(t.height)||48)-o*2;return h.jsx("div",{className:W.row,style:{...t,"--row-gap":`${o}px`,"--card-size":`${a}px`},children:e.map((c,r)=>h.jsx("div",{children:n(c)},r+s))})};ae.displayName="Row";const ke=f.memo(({value:e,onToggle:t,isFlashing:o=!1,className:n})=>{const[s,i]=f.useState(!1),a=f.useCallback(()=>{i(!0),t?.(),setTimeout(()=>i(!1),200)},[t]);return h.jsx("div",{className:oe(W.dataCard,s&&W.dataCardSelected,o&&W.dataCardFlash,n),onClick:a,children:e})}),ee=e=>{let t;const o=new Set,n=(l,d)=>{const u=typeof l=="function"?l(t):l;if(!Object.is(u,t)){const I=t;t=d??(typeof u!="object"||u===null)?u:Object.assign({},t,u),o.forEach(g=>g(t,I))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>r,subscribe:l=>(o.add(l),()=>o.delete(l))},r=t=e(n,s,c);return c},Me=(e=>e?ee(e):ee),Te=e=>e;function Ve(e,t=Te){const o=L.useSyncExternalStore(e.subscribe,L.useCallback(()=>t(e.getState()),[e,t]),L.useCallback(()=>t(e.getInitialState()),[e,t]));return L.useDebugValue(o),o}const te=e=>{const t=Me(e),o=n=>Ve(t,n);return Object.assign(o,t),o},Ae=(e=>e?te(e):te),He=e=>(t,o,n)=>{const s=n.subscribe;return n.subscribe=((a,c,r)=>{let l=a;if(c){const d=r?.equalityFn||Object.is;let u=a(n.getState());l=I=>{const g=a(I);if(!d(u,g)){const x=u;c(u=g,x)}},r?.fireImmediately&&c(u,u)}return s(l)}),e(t,o,n)},Ne=He;let ce=0;const Fe=e=>Array.from({length:e},()=>({id:ce++,value:Math.random()>.5?1:0}));let H=null,k=null,$=null,A=null,U=0;const J=100,ne=1e4,se=e=>{typeof requestIdleCallback<"u"?requestIdleCallback(e,{timeout:5}):setTimeout(e,0)},We=async e=>{if(e===0)return Promise.resolve();if(H&&k&&U===e||A&&U===e)return A;U=e,H=null,k=null,$=null,A=null,ce=0;const t=Math.ceil(ne/J);return A=new Promise(o=>{const n=[];let s=0;const i=()=>{const a=s*J,r=Math.min(a+J,ne)-a,l=Fe(r);n.push(...l),s++,s<t?se(i):(H=Object.fromEntries(n.map(d=>[d.id,d])),k=n.map(d=>d.id),$=Array.from({length:Math.ceil(k.length/e)},(d,u)=>k.slice(u*e,(u+1)*e)),o())};se(i)}),A},O=Ae()(Ne((e,t)=>{const o=async n=>{n!==0&&(await We(n),H&&k&&$&&e({entities:H,entityIds:k,rows:$,itemsPerRow:n}))};return{entities:H||{},entityIds:k||[],rows:$||[],itemsPerRow:U,gap:8,visibleRowStartIndex:0,visibleRowStopIndex:20,flashingItemIds:{},toggleValue:n=>e(s=>{const i=s.entities[n];return i?{entities:{...s.entities,[n]:{...i,value:i.value===0?1:0}}}:s}),setItemsPerRow:n=>{t().itemsPerRow!==n&&o(n)},setVisibleRowRange:(n,s)=>{const i=t();(i.visibleRowStartIndex!==n||i.visibleRowStopIndex!==s)&&e({visibleRowStartIndex:n,visibleRowStopIndex:s})},getRowItemIds:n=>t().rows[n]||[],getEntityValue:n=>t().entities[n]?.value,triggerRandomFlash:(n=1)=>{e(s=>{if(!s.rows.length)return s;const i=s.visibleRowStartIndex,a=s.visibleRowStopIndex,c=[];for(let u=0;u<n;u++){const I=Math.floor(Math.random()*(a-i+1))+i,g=s.rows[I];if(g&&g.length>0){const x=Math.floor(Math.random()*g.length),p=g[x];p!==void 0&&!s.flashingItemIds[p]&&c.push(p)}}if(c.length===0)return s;const r={};c.forEach(u=>{r[u]=!0});const l={...s.flashingItemIds,...r},d=c;return setTimeout(()=>{e(u=>{const{flashingItemIds:I}=u,g=Object.fromEntries(Object.entries(I).filter(([x])=>!d.includes(Number(x))));return Object.keys(g).length===Object.keys(I).length?u:{flashingItemIds:g}})},300),{flashingItemIds:l}})},isItemFlashing:n=>t().flashingItemIds[n]===!0}})),le=f.memo(({itemId:e})=>{const t=O(i=>i.entities[e]?.value),o=O(i=>i.toggleValue),n=O(i=>i.flashingItemIds[e]===!0),s=f.useCallback(()=>{o(e)},[e,o]);return t===void 0?null:h.jsx(ke,{value:t,onToggle:s,isFlashing:n})});le.displayName="DataRowItem";const $e=f.memo(({index:e,style:t})=>{const o=O(i=>i.rows[e])||[],n=O(i=>i.gap),s=f.useCallback(i=>h.jsx(le,{itemId:i}),[]);return o?.length?h.jsx(ae,{items:o,style:t,gap:n,renderItem:s,rowIndex:e}):h.jsx("div",{style:t})}),Pe="_section_8o688_1",Be="_heading_8o688_12",De="_subheading_8o688_17",Le="_loading_8o688_24",qe="_dataContainer_8o688_28",N={section:Pe,heading:Be,subheading:De,loading:Le,dataContainer:qe},ie=56,q=8,Ye=()=>{const e=f.useRef(null),t=ue(e),o=f.useRef(null),n=de(o,!0),s=O(r=>r.rows.length),i=O(r=>r.itemsPerRow),a=O(r=>r.setItemsPerRow),c=O(r=>r.triggerRandomFlash);return f.useEffect(()=>{if(!t)return;const r=setInterval(()=>{c(3)},150);return()=>{clearInterval(r)}},[t,c]),f.useLayoutEffect(()=>{const r=o.current;if(!r)return;const l=r.clientWidth;if(l<=0)return;const d=window.getComputedStyle(r),u=parseFloat(d.paddingLeft)||0,I=parseFloat(d.paddingRight)||0,x=l-u-I-q*2,p=ie-q*2,m=Math.max(1,Math.floor((x+q)/(p+q)));m!==i&&a(m)},[n.width,i,a]),h.jsxs("section",{className:N.section,ref:e,children:[h.jsx(Y.div,{initial:{opacity:0,y:30,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{duration:.8,delay:.3},children:h.jsx(K,{variant:"h1",className:N.heading,children:"Data intensive"})}),h.jsx(Y.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:3.5},children:h.jsxs(K,{variant:"subheading",className:N.subheading,color:"muted",children:[h.jsx(K,{as:"span",variant:"body",color:"primary",weight:"medium",children:"Issue:"})," ","Rendering ",s*i," data points"]})}),h.jsx(Y.div,{ref:o,className:N.dataContainer,initial:{opacity:0},animate:{opacity:1},transition:{duration:1,delay:1},children:s>0?h.jsx(Oe,{rowCount:s,rowComponent:$e,rowHeight:ie,height:600}):h.jsx("div",{className:N.loading,children:"Loading data..."})})]})};export{Ye as ThirdScreen};
